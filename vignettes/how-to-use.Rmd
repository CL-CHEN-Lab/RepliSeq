---
title: "how-to-use"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{how-to-use}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(RepliSeq)
```

# readRS(paths_data,fractions) :

This functions reads Repli-seq assays from multiple files (one file for one fraction) and outputs a dataframe from it.
It requires bedgraph inputs with a one line header listing options, with **no other comments** such as : [(bedgraph spec)](http://genome.ucsc.edu/goldenPath/help/bedgraph.html)   
track 	type=bedGraph 	name=NT_chr22-s1	description=50kbprofile   
chr22	0	50000	0   
chr22	50000	100000	0   

```{r}

### args :
temp_paths <- c("../inst/extdata/NT_chr22-s1.bdg","../inst/extdata/NT_chr22-s2.bdg","../inst/extdata/NT_chr22-s3.bdg",
                "../inst/extdata/NT_chr22-s4.bdg","../inst/extdata/NT_chr22-s5.bdg","../inst/extdata/NT_chr22-s6.bdg")
temp_fractions <- c("S1","S2","S3","S4","S5","S6")

### 2 fractions RepliSeq
# apply function :
RS_early <- readRS(temp_paths[1:2],temp_fractions[1:2])
# outputs :
tail(RS_early)
typeof(RS_early)
summary(RS_early)

### 6 fractions RepliSeq
# apply function :
RS_all <- readRS(temp_paths,temp_fractions)
# outputs :
tail(RS_all)

### 1 fraction RepliSeq ( for S0 controls )
# apply function : 
RS_S0 <- readRS(temp_paths[1],"S0")
# outputs :
tail(RS_S0)

```

# rescaleRS(rs_assay,scale_factor) :

This functions rescales Repli-seq assays loaded with readRS to lower resolution ( e.g. from 1kb windows to 50kb windows or 100kb)

```{r}

# To rescale from 50kb to 100kb the scale_factor is 2 ( from 1kb to 50kb it would be 50)

### 2 fractions RepliSeq
# apply function :
RS_early_100kb <- rescaleRS(RS_early,2)
# outputs :
tail(RS_early_100kb)

### 2 fractions RepliSeq
# apply function :
RS_all_100kb <- rescaleRS(RS_all,2)
# outputs :
tail(RS_all_100kb)

### 1 fraction RepliSeq ( for S0 controls )
# apply function :
RS_S0_100kb <- rescaleRS(RS_S0,2)
# outputs :
tail(RS_S0_100kb)

```

# smoothRS(rs_assay,scale_factor) :

This functions rescales Repli-seq assays loaded with readRS to lower resolution ( e.g. from 1kb windows to 50kb windows or 100kb)

```{r}

# To get 50kb smoothed profiles from 1kb adjacent profiles smooth_factor = 50 --> results in count matrices with 
# genomic windows having a step = 1kb and a span of 50kb.
# From 50kb to 100kb the smooth_factor is 2 

### 2 fractions RepliSeq
# apply function :
RS_early_smoothed_2 <- smoothRS(RS_early,2)
# outputs :
tail(RS_early_smoothed_2)

### 2 fractions RepliSeq
# apply function :
RS_all_100kb <- rescaleRS(RS_all,2)
# outputs :
tail(RS_all_100kb)

### 1 fraction RepliSeq ( for S0 controls )
# apply function :
RS_S0_100kb <- rescaleRS(RS_S0,2)
# outputs :
tail(RS_S0_100kb)

```


# calculateS50(rs_assay,fractions) :

```{r}

### 2 fractions RepliSeq
# apply function :
temp.S50 <- RepliSeq::calculateS50(RS_early,temp_fractions[1:2])
# outputs :
tail(temp.S50)

### 6 fractions RepliSeq
# apply function :
temp.S50 <- RepliSeq::calculateS50(RS_all,temp_fractions)
# outputs :
tail(temp.S50)
summary(temp.S50$S50)

```


# calculateURI(rs_x, rs_y) :

This functions calculates URI between two Repli-seq assays. It returns a dataframe with the following columns :   
chr,start,stop,sum_x,sum_y,mean_xy,URI


```{r}
## load second Repli-seq assay for comparison :
### args :
aph_paths <- c("../inst/extdata/Aph_chr22-s1.bdg","../inst/extdata/Aph_chr22-s2.bdg","../inst/extdata/Aph_chr22-s3.bdg",
                "../inst/extdata/Aph_chr22-s4.bdg","../inst/extdata/Aph_chr22-s5.bdg","../inst/extdata/Aph_chr22-s6.bdg")
aph_fractions <- c("S1","S2","S3","S4","S5","S6")

# read :
RS_aph_all <- readRS(aph_paths,aph_fractions)
RS_aph_early <- readRS(aph_paths[1:2],aph_fractions[1:2])

### 2 fractions RepliSeq
# apply function :
aph_nt_uri <- calculateURI(RS_aph_early,RS_early)
# outputs :
tail(aph_nt_uri)

### 6 fractions RepliSeq
# apply function :
aph_nt_uri <- calculateURI(RS_aph_all,RS_all)
# outputs :
tail(aph_nt_uri)



```

